(self.webpackChunkaa_webauthn_demo=self.webpackChunkaa_webauthn_demo||[]).push([[741],{75439:(e,a,t)=>{"use strict";t.d(a,{M:()=>n});var r=t(56816),s=t(80184);const n=e=>{let{buttonText:a,onClick:t,disabled:n=!1,testId:i="",loading:o=!1,sx:l}=e;return(0,s.jsx)(r.Z,{size:"small",variant:"contained",sx:{...l,backgroundColor:"black",borderRadius:2},onClick:t,disabled:n,"data-testid":i,loading:o,children:a})}},55511:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>f});var r=t(72791),s=t(77257),n=t(57621),i=t(39504),o=t(20890),l=t(72363),c=t(42139),d=t(50533),u=t(49673),h=t(87499),p=t(17303),g=t(75439),x=t(95400),y=t(98402),b=t(70188),m=t(80184);const f=(0,s.Pi)((()=>{const{appStore:e}=(0,x.oR)(),a=e.accountAddress,[t,s]=(0,r.useState)(!1),[f,v]=(0,r.useState)("");return a?(0,m.jsx)(m.Fragment,{children:(0,m.jsxs)(n.Z,{variant:"outlined",sx:{minWidth:275,borderRadius:5},children:[(0,m.jsx)(i.Z,{sx:{pb:1},children:(0,m.jsx)(o.Z,{display:"inline",sx:{fontSize:26},children:"Add Recovery Email"})}),(0,m.jsxs)(l.Z,{sx:{pl:2,pr:2,pb:2},children:[(0,m.jsx)(c.Z,{id:"email",label:"Email",variant:"filled",onChange:e=>{v(e.target.value)}}),(0,m.jsx)(g.M,{buttonText:"Add Recovery Email",sx:{ml:1},onClick:()=>(async a=>{let{email:t}=a;e.accountAddress||(e.snackBarMessage="Please create account first",e.openSnackBar=!0);try{s(!0);const a=new y.A(e.transports,b.cc,e.createCredential,e.publicKey),t=await u.Client.init(b.Bp,{entryPoint:b.m$,overrideBundlerRpc:b.kK}),r=await h.SmartAccount.init(a,b.Bp,{overrideBundlerRpc:b.kK,entryPoint:b.m$,factory:b.BJ,paymasterMiddleware:u.Presets.Middleware.verifyingPaymaster(b.RZ,{type:"payg"})});console.log("accountBuilder",r);const n=new p.vU(["function execute(address,uint256,bytes)"]).encodeFunctionData("execute",["0x22C1317FE43132b22860e8b465548613d6151a9F",0,"0x"]);r.setCallData(n);const i=await t.sendUserOperation(r);e.addRecoveryEmailTxHash=i.userOpHash;const o=await i.wait();console.log("userOperationEvent",o),o&&(e.snackBarMessage="Recovery email added successfully!",e.openSnackBar=!0)}catch(r){console.error(r),e.snackBarMessage=`${r.toString()}`,e.openSnackBar=!0}finally{s(!1)}})({email:f}),testId:"send-transaction",loading:t})]}),e.addRecoveryEmailTxHash&&(0,m.jsx)(i.Z,{sx:{pb:1},children:e.addRecoveryEmailTxHash&&(0,m.jsxs)(o.Z,{sx:{fontSize:16},children:["Transaction Details: ",(0,m.jsx)(d.Z,{underline:"always",target:"_blank",rel:"noopener",href:`https://dashboard.tenderly.co/tx/sepolia/${e.addRecoveryEmailTxHash}?trace=0`,children:e.addRecoveryEmailTxHash})]})})]})}):null}))},98402:(e,a,t)=>{"use strict";t.d(a,{A:()=>c});var r=t(2257),s=t(73580),n=t(19967),i=t(51063),o=t(36411),l=t(19778).Buffer;class c{constructor(e,a,t,r){this.transports=e,this.addr=a,this.credential=t,this.publicKey=r}signatureLength(){return 1280}address(){return this.addr}async data(){const e=await(0,i.pJ)(this.publicKey);console.log("jwk",e);const a=l.from(n.P6.parseBase64url(e.x.toString())),t=l.from(n.P6.parseBase64url(e.y.toString()));return s.defaultAbiCoder.encode(["uint256","uint256"],[r.O$.from(a),r.O$.from(t)])}shouldRemoveLeadingZero(e){return 0===e[0]&&0!==(128&e[1])}async sign(e){const a=n.P6.toBase64url((0,s.arrayify)(e)).replace(/=/g,"");console.log("challenge",a),console.log("create credential",this.credential);const t=n.P6.parseBase64url(a),l=await(0,o.YR)(t,this.credential.rawId,this.transports);console.log("get credential",l.credential);const c=(new TextDecoder).decode(n.P6.parseBase64url(n.P6.toBase64url(l.credential.clientDataJSON))),d=c.indexOf(a),u=c.substring(0,d),h=c.substring(d+a.length),p=new Uint8Array(l.credential.authenticatorData),g=(0,i.bL)(l.credential.signature);let x=g.r,y=g.s;this.shouldRemoveLeadingZero(x)&&(x=x.slice(1)),this.shouldRemoveLeadingZero(y)&&(y=y.slice(1));const b=s.defaultAbiCoder.encode(["uint256","uint256"],[r.O$.from(x),r.O$.from(y)]);return console.log(b,p,u,h),s.defaultAbiCoder.encode(["bytes","bytes","string","string"],[b,p,u,h])}}},46601:()=>{},89214:()=>{},8623:()=>{},7748:()=>{},85568:()=>{},56619:()=>{},83736:()=>{},77108:()=>{},52361:()=>{},94616:()=>{}}]);
//# sourceMappingURL=741.0cd852c3.chunk.js.map