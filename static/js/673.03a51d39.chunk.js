"use strict";(self.webpackChunkaa_webauthn_demo=self.webpackChunkaa_webauthn_demo||[]).push([[673],{75439:(e,t,s)=>{s.d(t,{M:()=>r});var n=s(56816),a=s(80184);const r=e=>{let{buttonText:t,onClick:s,disabled:r=!1,testId:o="",loading:c=!1,sx:d}=e;return(0,a.jsx)(n.Z,{size:"small",variant:"contained",sx:{...d,backgroundColor:"black",borderRadius:2},onClick:s,disabled:r,"data-testid":o,loading:c,children:t})}},52673:(e,t,s)=>{s.r(t),s.d(t,{default:()=>y});var n=s(72791),a=s(77257),r=s(57621),o=s(39504),c=s(20890),d=s(72363),i=s(34029),l=s(2257),u=s(65054),b=s(73580),x=s(19967),m=s(75439),p=s(52029),f=s(70188),h=s(80184),w=s(19778).Buffer;const y=(0,a.Pi)((()=>{const{appStore:e}=(0,p.oR)(),t=e.recoveryEmail,[s,a]=(0,n.useState)(!1),[y,g]=(0,n.useState)("0x"),C=(0,n.useMemo)((()=>{if(e.provider)return new i.CH(f.cc,f.k9,e.provider)}),[e.provider]);(0,n.useEffect)((()=>{(async()=>t?await C.publicKeys(e.accountAddress,e.createCredentialId):"0x")().then((e=>{"0x"!==e&&(console.log("publicKey",e),g(e))}))}),[t,e.accountAddress,e.createCredentialId,C]);return t?(0,h.jsx)(h.Fragment,{children:(0,h.jsxs)(r.Z,{variant:"outlined",sx:{minWidth:275,borderRadius:5},children:[(0,h.jsx)(o.Z,{sx:{pb:1},children:(0,h.jsx)(c.Z,{display:"inline",sx:{fontSize:26},children:"Send Email to Bind New Credential"})}),(0,h.jsx)(d.Z,{sx:{pl:2,pr:2,pb:2},children:(0,h.jsx)(m.M,{buttonText:"Send Email",sx:{ml:1},onClick:async()=>{t||e.showSnackBar("Please add recovery email first");try{a(!0),console.log("webAuthn contract",C);const t=await C.emails(e.accountAddress);console.log("email",t);const s=await C.recoveryNonce(e.accountAddress);console.log("nonce",l.O$.from(s).toNumber()),console.log("credentialId",e.createCredentialId);const n=await C.publicKeys(e.accountAddress,e.createCredentialId);console.log("publicKey",n);const r=w.from(x.P6.parseBase64url(e.publicKey.x.toString())),o=w.from(x.P6.parseBase64url(e.publicKey.y.toString())),c=b.defaultAbiCoder.encode(["uint256","uint256"],[l.O$.from(r),l.O$.from(o)]),d=u.$.encode(["uint256","address","address","uint256","bytes","string"],[f.Bv,f.cc,e.accountAddress,s,c,e.createCredentialId]),i=f.pC;window.open(`https://mail.google.com/mail/u/1/?view=cm&fs=1&tf=1&to=${i}&su=${d.slice(2)}`,"_blank");do{const t=await C.publicKeys(e.accountAddress,e.createCredentialId);if("0x"!==t){g(t),console.log("recoveredPublicKey",y);break}await new Promise((e=>setTimeout(e,2e3)))}while("0x"===y)}catch(s){console.error(s),e.showSnackBar(`${s.toString()}`)}finally{a(!1)}},testId:"send-email",loading:s,disabled:"0x"!==y})}),(0,h.jsx)(o.Z,{sx:{pb:1},children:(0,h.jsxs)(c.Z,{sx:{fontSize:14},children:[`Account Address: ${e.accountAddress}`,(0,h.jsx)("br",{}),`Credential ID: ${e.createCredentialId}`,(0,h.jsx)("br",{}),`Public Key: ${y}`]})})]})}):null}))}}]);
//# sourceMappingURL=673.03a51d39.chunk.js.map