"use strict";(self.webpackChunkaa_webauthn_demo=self.webpackChunkaa_webauthn_demo||[]).push([[673],{75439:(e,s,t)=>{t.d(s,{M:()=>o});var a=t(56816),n=t(80184);const o=e=>{let{buttonText:s,onClick:t,disabled:o=!1,testId:r="",loading:c=!1,sx:d}=e;return(0,n.jsx)(a.Z,{size:"small",variant:"contained",sx:{...d,backgroundColor:"black",borderRadius:2},onClick:t,disabled:o,"data-testid":r,loading:c,children:s})}},52673:(e,s,t)=>{t.r(s),t.d(s,{default:()=>w});var a=t(72791),n=t(77257),o=t(57621),r=t(39504),c=t(20890),d=t(72363),i=t(34029),l=t(2257),u=t(65054),b=t(73580),x=t(19967),p=t(75439),m=t(52029),y=t(70188),f=t(80184),h=t(19778).Buffer;const w=(0,n.Pi)((()=>{const{appStore:e}=(0,m.oR)(),s=e.recoveryEmail,[t,n]=(0,a.useState)(!1),[w,g]=(0,a.useState)("0x"),k=(0,a.useMemo)((()=>{if(e.provider)return new i.CH(y.cc,y.k9,e.provider)}),[e.provider]);(0,a.useEffect)((()=>{(async()=>s?await k.publicKeys(e.accountAddress,e.createCredentialId):"0x")().then((e=>{"0x"!==e&&(console.log("publicKey",e),g(e))}))}),[s,e.accountAddress,e.createCredentialId,k]);return s?(0,f.jsx)(f.Fragment,{children:(0,f.jsxs)(o.Z,{variant:"outlined",sx:{minWidth:275,borderRadius:5},children:[(0,f.jsx)(r.Z,{sx:{pb:1},children:(0,f.jsx)(c.Z,{display:"inline",sx:{fontSize:26},children:"Send Email to Bind New Passkey"})}),(0,f.jsx)(d.Z,{sx:{pl:2,pr:2,pb:2},children:(0,f.jsx)(p.M,{buttonText:"Send Email",sx:{ml:1},onClick:async()=>{s||e.showSnackBar("Please add recovery email first");try{n(!0),console.log("webAuthn contract",k);const s=await k.emails(e.accountAddress);console.log("email",s);const t=await k.recoveryNonce(e.accountAddress);console.log("nonce",l.O$.from(t).toNumber()),console.log("passkeyId",e.createCredentialId);const a=await k.publicKeys(e.accountAddress,e.createCredentialId);console.log("publicKey",a);const o=h.from(x.P6.parseBase64url(e.publicKey.x.toString())),r=h.from(x.P6.parseBase64url(e.publicKey.y.toString())),c=b.defaultAbiCoder.encode(["uint256","uint256"],[l.O$.from(o),l.O$.from(r)]),d=u.$.encode(["uint256","address","address","uint256","bytes","string"],[y.Bv,y.cc,e.accountAddress,t,c,e.createCredentialId]),i=y.pC;window.open(`https://mail.google.com/mail/u/1/?view=cm&fs=1&tf=1&to=${i}&su=${d.slice(2)}`,"_blank");do{const s=await k.publicKeys(e.accountAddress,e.createCredentialId);if("0x"!==s){g(s),console.log("recoveredPublicKey",w);break}await new Promise((e=>setTimeout(e,2e3)))}while("0x"===w)}catch(t){console.error(t),e.showSnackBar(`${t.toString()}`)}finally{n(!1)}},testId:"send-email",loading:t,disabled:"0x"!==w})}),(0,f.jsx)(r.Z,{sx:{pb:1},children:(0,f.jsxs)(c.Z,{sx:{fontSize:14},children:[`Account Address: ${e.accountAddress}`,(0,f.jsx)("br",{}),`Passkey ID: ${e.createCredentialId}`,(0,f.jsx)("br",{}),`Public Key: ${w}`]})})]})}):null}))}}]);
//# sourceMappingURL=673.e2344f18.chunk.js.map