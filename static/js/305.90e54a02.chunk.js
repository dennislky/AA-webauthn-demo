(self.webpackChunkaa_webauthn_demo=self.webpackChunkaa_webauthn_demo||[]).push([[305],{75439:(e,t,a)=>{"use strict";a.d(t,{M:()=>s});var r=a(56816),n=a(80184);const s=e=>{let{buttonText:t,onClick:a,disabled:s=!1,testId:i="",loading:o=!1,sx:l}=e;return(0,n.jsx)(r.Z,{size:"small",variant:"contained",sx:{...l,backgroundColor:"black",borderRadius:2},onClick:a,disabled:s,"data-testid":i,loading:o,children:t})}},74464:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>m});var r=a(72791),n=a(77257),s=a(57621),i=a(39504),o=a(20890),l=a(72363),d=a(42139),c=a(50533),u=a(49673),p=a(87499),h=a(2257),g=a(17303),x=a(75439),b=a(95400),f=a(98402),v=a(70188),y=a(80184);const m=(0,n.Pi)((()=>{const{appStore:e}=(0,b.oR)(),t=e.accountAddress,[a,n]=(0,r.useState)(!1),[m,w]=(0,r.useState)(""),[k,B]=(0,r.useState)(0);return t?(0,y.jsx)(y.Fragment,{children:(0,y.jsxs)(s.Z,{variant:"outlined",sx:{minWidth:275,borderRadius:5},children:[(0,y.jsx)(i.Z,{sx:{pb:1},children:(0,y.jsx)(o.Z,{display:"inline",sx:{fontSize:26},children:"Approve"})}),(0,y.jsxs)(l.Z,{sx:{pl:2,pr:2,pb:2},children:[(0,y.jsx)(d.Z,{id:"address",label:"Address",variant:"filled",onChange:e=>{w(e.target.value)}}),(0,y.jsx)(d.Z,{id:"value",label:"Value",variant:"filled",onChange:e=>{B(e.target.value)}}),(0,y.jsx)(x.M,{buttonText:"Approve",sx:{ml:1},onClick:()=>(async t=>{let{target:a,value:r}=t;e.accountAddress||(e.snackBarMessage="Please create account first",e.openSnackBar=!0);try{n(!0);const t=new f.A(e.transports,v.cc,e.createCredential,e.publicKey),s=await u.Client.init(v.Bp,{entryPoint:v.m$,overrideBundlerRpc:v.kK}),i=await p.SmartAccount.init(t,v.Bp,{overrideBundlerRpc:v.kK,entryPoint:v.m$,factory:v.BJ,paymasterMiddleware:u.Presets.Middleware.verifyingPaymaster(v.RZ,{type:"payg"})});console.log("accountBuilder",i);const o=h.O$.from(r.toString()),l=h.O$.from(10).pow(18),d=o.mul(l),c=new g.vU(["function approve(address,uint256)"]).encodeFunctionData("approve",[a,d.toString()]),x=new g.vU(["function execute(address,uint256,bytes)"]).encodeFunctionData("execute",["0x22C1317FE43132b22860e8b465548613d6151a9F",0,c]);i.setCallData(x);const b=await s.sendUserOperation(i);e.approves.push({txHash:b.userOpHash})}catch(s){console.error(s),e.snackBarMessage=`${s.toString()}`,e.openSnackBar=!0}finally{n(!1)}})({target:m,value:1e3*k}),testId:"approve",loading:a})]}),e.approves.map(((e,t)=>(0,y.jsx)(i.Z,{sx:{pb:1},children:e.txHash&&(0,y.jsxs)(o.Z,{sx:{fontSize:16},children:["Transaction Details: ",(0,y.jsx)(c.Z,{underline:"always",target:"_blank",rel:"noopener",href:`https://dashboard.tenderly.co/tx/sepolia/${e.txHash}?trace=0`,children:e.txHash})]})},t)))]})}):null}))},98402:(e,t,a)=>{"use strict";a.d(t,{A:()=>d});var r=a(2257),n=a(73580),s=a(19967),i=a(51063),o=a(36411),l=a(19778).Buffer;class d{constructor(e,t,a,r){this.transports=e,this.addr=t,this.credential=a,this.publicKey=r}signatureLength(){return 1280}address(){return this.addr}async data(){const e=await(0,i.pJ)(this.publicKey);console.log("jwk",e);const t=l.from(s.P6.parseBase64url(e.x.toString())),a=l.from(s.P6.parseBase64url(e.y.toString()));return n.defaultAbiCoder.encode(["uint256","uint256"],[r.O$.from(t),r.O$.from(a)])}shouldRemoveLeadingZero(e){return 0===e[0]&&0!==(128&e[1])}async sign(e){const t=s.P6.toBase64url((0,n.arrayify)(e)).replace(/=/g,"");console.log("challenge",t),console.log("create credential",this.credential);const a=s.P6.parseBase64url(t),l=await(0,o.YR)(a,this.credential.rawId,this.transports);console.log("get credential",l.credential);const d=(new TextDecoder).decode(s.P6.parseBase64url(s.P6.toBase64url(l.credential.clientDataJSON))),c=d.indexOf(t),u=d.substring(0,c),p=d.substring(c+t.length),h=new Uint8Array(l.credential.authenticatorData),g=(0,i.bL)(l.credential.signature);let x=g.r,b=g.s;this.shouldRemoveLeadingZero(x)&&(x=x.slice(1)),this.shouldRemoveLeadingZero(b)&&(b=b.slice(1));const f=n.defaultAbiCoder.encode(["uint256","uint256"],[r.O$.from(x),r.O$.from(b)]);return console.log(f,h,u,p),n.defaultAbiCoder.encode(["bytes","bytes","string","string"],[f,h,u,p])}}},46601:()=>{},89214:()=>{},8623:()=>{},7748:()=>{},85568:()=>{},56619:()=>{},83736:()=>{},77108:()=>{},52361:()=>{},94616:()=>{}}]);
//# sourceMappingURL=305.90e54a02.chunk.js.map