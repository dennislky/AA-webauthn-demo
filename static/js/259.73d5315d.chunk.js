(self.webpackChunkaa_webauthn_demo=self.webpackChunkaa_webauthn_demo||[]).push([[259],{75439:(e,t,r)=>{"use strict";r.d(t,{M:()=>s});var a=r(56816),n=r(80184);const s=e=>{let{buttonText:t,onClick:r,disabled:s=!1,testId:c="",loading:o=!1}=e;return(0,n.jsx)(a.Z,{size:"small",variant:"contained",sx:{backgroundColor:"black",borderRadius:2},onClick:r,disabled:s,"data-testid":c,loading:o,children:t})}},89914:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>A});var a=r(72791),n=r(77257),s=r(57621),c=r(39504),o=r(20890),i=r(72363),l=r(50533),d=r(49673),u=r(87499),h=r(75439),p=r(95400),g=r(2257),x=r(73580),b=r(19967),y=r(51063),f=r(36411),k=r(19778).Buffer;class w{constructor(e,t,r,a){this.transports=e,this.addr=t,this.credential=r,this.publicKey=a}signatureLength(){return 1280}address(){return this.addr}async data(){const e=await(0,y.pJ)(this.publicKey);console.log("jwk",e);const t=k.from(b.P6.parseBase64url(e.x.toString())),r=k.from(b.P6.parseBase64url(e.y.toString()));return x.defaultAbiCoder.encode(["uint256","uint256"],[g.O$.from(t),g.O$.from(r)])}shouldRemoveLeadingZero(e){return 0===e[0]&&0!==(128&e[1])}async sign(e){const t=b.P6.toBase64url((0,x.arrayify)(e)).replace(/=/g,"");console.log("challenge",t),console.log("create credential",this.credential);const r=b.P6.parseBase64url(t),a=await(0,f.YR)(r,this.credential.rawId,this.transports);console.log("get credential",a.credential);const n=(new TextDecoder).decode(b.P6.parseBase64url(b.P6.toBase64url(a.credential.clientDataJSON))),s=n.indexOf(t),c=n.substring(0,s),o=n.substring(s+t.length),i=new Uint8Array(a.credential.authenticatorData),l=(0,y.bL)(a.credential.signature);let d=l.r,u=l.s;this.shouldRemoveLeadingZero(d)&&(d=d.slice(1)),this.shouldRemoveLeadingZero(u)&&(u=u.slice(1));const h=x.defaultAbiCoder.encode(["uint256","uint256"],[g.O$.from(d),g.O$.from(u)]);return console.log(h,i,c,o),x.defaultAbiCoder.encode(["bytes","bytes","string","string"],[h,i,c,o])}}var m=r(70188),B=r(80184);const A=(0,n.Pi)((()=>{const{appStore:e}=(0,p.oR)(),t=e.isInit,[r,n]=(0,a.useState)(!1);return t?(0,B.jsx)(B.Fragment,{children:(0,B.jsxs)(s.Z,{variant:"outlined",sx:{minWidth:275,borderRadius:5},children:[(0,B.jsx)(c.Z,{sx:{pb:1},children:(0,B.jsx)(o.Z,{display:"inline",sx:{fontSize:26},children:"Create Account"})}),(0,B.jsx)(i.Z,{sx:{pl:2,pr:2,pb:2},children:(0,B.jsx)(h.M,{buttonText:"Create Account",onClick:async()=>{e.isInit||(e.snackBarMessage="Please create passkey first",e.openSnackBar=!0);try{n(!0);const t=new w(e.transports,m.cc,e.createCredential,e.publicKey),r=await d.Client.init(m.Bp,{entryPoint:m.m$,overrideBundlerRpc:m.kK}),a=await u.SmartAccount.init(t,m.Bp,{overrideBundlerRpc:m.kK,entryPoint:m.m$,factory:m.BJ,paymasterMiddleware:d.Presets.Middleware.verifyingPaymaster(m.RZ,{type:"payg"})});console.log("accountBuilder",a);const s=await r.sendUserOperation(a);e.accountAddress=a.getSender(),e.createAccountTxHash=s.userOpHash;const c=await s.wait();console.log("userOperationEvent",c),c&&(e.snackBarMessage="Account created successfully!",e.openSnackBar=!0)}catch(t){console.error(t),e.snackBarMessage=`${t.toString()}`,e.openSnackBar=!0}finally{n(!1)}},testId:"create-account",loading:r})}),(0,B.jsxs)(c.Z,{sx:{pb:1},children:[e.createAccountTxHash&&(0,B.jsxs)(o.Z,{sx:{fontSize:16},children:["Transaction Details: ",(0,B.jsx)(l.Z,{underline:"always",target:"_blank",rel:"noopener",href:`https://dashboard.tenderly.co/tx/sepolia/${e.createAccountTxHash}?trace=0`,children:e.createAccountTxHash})]}),e.accountAddress&&(0,B.jsxs)(o.Z,{sx:{fontSize:16},children:["Account Address: ",(0,B.jsx)(l.Z,{underline:"always",target:"_blank",rel:"noopener",href:`https://sepolia.etherscan.io/address/${e.accountAddress}`,children:e.accountAddress})]})]})]})}):null}))},46601:()=>{},89214:()=>{},8623:()=>{},7748:()=>{},85568:()=>{},56619:()=>{},83736:()=>{},77108:()=>{},52361:()=>{},94616:()=>{}}]);
//# sourceMappingURL=259.73d5315d.chunk.js.map