"use strict";(self.webpackChunkaa_webauthn_demo=self.webpackChunkaa_webauthn_demo||[]).push([[673],{75439:(e,s,t)=>{t.d(s,{M:()=>n});var a=t(56816),o=t(80184);const n=e=>{let{buttonText:s,onClick:t,disabled:n=!1,testId:r="",loading:c=!1,sx:d}=e;return(0,o.jsx)(a.Z,{size:"small",variant:"contained",sx:{...d,backgroundColor:"black",borderRadius:2},onClick:t,disabled:n,"data-testid":r,loading:c,children:s})}},52673:(e,s,t)=>{t.r(s),t.d(s,{default:()=>w});var a=t(72791),o=t(77257),n=t(57621),r=t(39504),c=t(20890),d=t(72363),i=t(34029),l=t(2257),u=t(65054),b=t(73580),x=t(19967),p=t(75439),m=t(52029),y=t(70188),h=t(80184),f=t(19778).Buffer;const w=(0,o.Pi)((()=>{const{appStore:e}=(0,m.oR)(),s=e.recoveryEmail,[t,o]=(0,a.useState)(!1),[w,g]=(0,a.useState)("0x"),C=(0,a.useMemo)((()=>{if(e.provider)return new i.CH(y.cc,y.k9,e.provider)}),[e.provider]);(0,a.useEffect)((()=>{(async()=>s?await C.publicKeys(e.accountAddress,e.createCredentialId):"0x")().then((e=>{"0x"!==e&&(console.log("publicKey",e),g(e))}))}),[s,e.accountAddress,e.createCredentialId,C]);return s?(0,h.jsx)(h.Fragment,{children:(0,h.jsxs)(n.Z,{variant:"outlined",sx:{minWidth:275,borderRadius:5},children:[(0,h.jsx)(r.Z,{sx:{pb:1},children:(0,h.jsx)(c.Z,{display:"inline",sx:{fontSize:26},children:"Send Recovery Email"})}),(0,h.jsx)(d.Z,{sx:{pl:2,pr:2,pb:2},children:(0,h.jsx)(p.M,{buttonText:"Send Recovery Email",sx:{ml:1},onClick:async()=>{s||e.showSnackBar("Please add recovery email first");try{o(!0),console.log("webAuthn contract",C);const s=await C.emails(e.accountAddress);console.log("email",s);const t=await C.recoveryNonce(e.accountAddress);console.log("nonce",l.O$.from(t).toNumber()),console.log("passkeyId",e.createCredentialId);const a=await C.publicKeys(e.accountAddress,e.createCredentialId);console.log("publicKey",a);const n=f.from(x.P6.parseBase64url(e.publicKey.x.toString())),r=f.from(x.P6.parseBase64url(e.publicKey.y.toString())),c=b.defaultAbiCoder.encode(["uint256","uint256"],[l.O$.from(n),l.O$.from(r)]),d=u.$.encode(["uint256","address","address","uint256","bytes","string"],[y.Bv,y.cc,e.accountAddress,t,c,e.createCredentialId]),i=y.pC;window.open(`https://mail.google.com/mail/u/1/?view=cm&fs=1&tf=1&to=${i}&su=${d.slice(2)}`,"_blank");do{const s=await C.publicKeys(e.accountAddress,e.createCredentialId);g(s),console.log("recoveredPublicKey",w),await new Promise((e=>setTimeout(e,2e3)))}while("0x"===w)}catch(t){console.error(t),e.showSnackBar(`${t.toString()}`)}finally{o(!1)}},testId:"send-email",loading:t,disabled:"0x"!==w})}),(0,h.jsx)(r.Z,{sx:{pb:1},children:(0,h.jsxs)(c.Z,{sx:{fontSize:16},children:[`Account Address: ${e.accountAddress}`,(0,h.jsx)("br",{}),`Passkey ID: ${e.createCredentialId}`,(0,h.jsx)("br",{}),`Public Key: ${w}`]})})]})}):null}))}}]);
//# sourceMappingURL=673.d24406fd.chunk.js.map