(self.webpackChunkaa_webauthn_demo=self.webpackChunkaa_webauthn_demo||[]).push([[259],{75439:(e,t,r)=>{"use strict";r.d(t,{M:()=>n});var a=r(56816),s=r(80184);const n=e=>{let{buttonText:t,onClick:r,disabled:n=!1,testId:c="",loading:o=!1}=e;return(0,s.jsx)(a.Z,{size:"small",variant:"contained",sx:{backgroundColor:"black",borderRadius:2},onClick:r,disabled:n,"data-testid":c,loading:o,children:t})}},89914:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>B});var a=r(72791),s=r(77257),n=r(57621),c=r(39504),o=r(20890),i=r(72363),l=r(50533),d=r(49673),u=r(87499),h=r(75439),p=r(95400),g=r(2257),x=r(73580),b=r(19967),y=r(51063),f=r(36411),k=r(19778).Buffer;class w{constructor(e,t,r,a){this.transports=e,this.addr=t,this.credential=r,this.publicKey=a}signatureLength(){return 1280}address(){return this.addr}async data(){const e=await(0,y.pJ)(this.publicKey);console.log("jwk",e);const t=k.from(b.P6.parseBase64url(e.x.toString())),r=k.from(b.P6.parseBase64url(e.y.toString()));return x.defaultAbiCoder.encode(["uint256","uint256"],[g.O$.from(t),g.O$.from(r)])}shouldRemoveLeadingZero(e){return 0===e[0]&&0!==(128&e[1])}async sign(e){const t=b.P6.toBase64url((0,x.arrayify)(e)).replace(/=/g,"");console.log("challenge",t),console.log("create credential",this.credential);const r=b.P6.parseBase64url(t),a=await(0,f.YR)(r,this.credential.rawId,this.transports);console.log("get credential",a.credential);const s=(new TextDecoder).decode(b.P6.parseBase64url(b.P6.toBase64url(a.credential.clientDataJSON))),n=s.indexOf(t),c=s.substring(0,n),o=s.substring(n+t.length),i=new Uint8Array(a.credential.authenticatorData),l=(0,y.bL)(a.credential.signature);let d=l.r,u=l.s;this.shouldRemoveLeadingZero(d)&&(d=d.slice(1)),this.shouldRemoveLeadingZero(u)&&(u=u.slice(1));const h=x.defaultAbiCoder.encode(["uint256","uint256"],[g.O$.from(d),g.O$.from(u)]);return console.log(h,i,c,o),x.defaultAbiCoder.encode(["bytes","bytes","string","string"],[h,i,c,o])}}var A=r(70188),m=r(80184);const B=(0,s.Pi)((()=>{const{appStore:e}=(0,p.oR)(),t=e.isInit,[r,s]=(0,a.useState)(!1);return t?(0,m.jsx)(m.Fragment,{children:(0,m.jsxs)(n.Z,{variant:"outlined",sx:{minWidth:275,borderRadius:5},children:[(0,m.jsx)(c.Z,{sx:{pb:1},children:(0,m.jsx)(o.Z,{display:"inline",sx:{fontSize:26},children:"Create Account"})}),(0,m.jsx)(i.Z,{sx:{pl:2,pr:2,pb:2},children:(0,m.jsx)(h.M,{buttonText:"Create Account",onClick:async()=>{e.isInit||(e.snackBarMessage="Please create passkey first",e.openSnackBar=!0);try{s(!0);const t=new w(e.transports,A.cc,e.createCredential,e.publicKey),r=await d.Client.init(A.Bp,{entryPoint:A.m$,overrideBundlerRpc:A.kK}),a=await u.SmartAccount.init(t,A.Bp,{overrideBundlerRpc:A.kK,entryPoint:A.m$,factory:A.BJ,paymasterMiddleware:d.Presets.Middleware.verifyingPaymaster(A.RZ,{type:"payg"})});console.log("accountBuilder",a);const n=await r.sendUserOperation(a);e.accountAddress=a.getSender(),e.createAccountTxHash=n.userOpHash;const c=await n.wait();console.log("userOperationEvent",c),c&&(e.snackBarMessage="Account created successfully!",e.openSnackBar=!0)}catch(t){console.error(t),e.snackBarMessage=`${t.toString()}`,e.openSnackBar=!0}finally{s(!1)}},testId:"create-account",loading:r})}),e.createAccountTxHash&&e.accountAddress&&(0,m.jsxs)(c.Z,{sx:{pb:1},children:[e.createAccountTxHash&&(0,m.jsxs)(o.Z,{sx:{fontSize:16},children:["Transaction Details: ",(0,m.jsx)(l.Z,{underline:"always",target:"_blank",rel:"noopener",href:`https://dashboard.tenderly.co/tx/sepolia/${e.createAccountTxHash}?trace=0`,children:e.createAccountTxHash})]}),e.accountAddress&&(0,m.jsxs)(o.Z,{sx:{fontSize:16},children:["Account Address: ",(0,m.jsx)(l.Z,{underline:"always",target:"_blank",rel:"noopener",href:`https://sepolia.etherscan.io/address/${e.accountAddress}`,children:e.accountAddress})]})]})]})}):null}))},46601:()=>{},89214:()=>{},8623:()=>{},7748:()=>{},85568:()=>{},56619:()=>{},83736:()=>{},77108:()=>{},52361:()=>{},94616:()=>{}}]);
//# sourceMappingURL=259.61e76358.chunk.js.map